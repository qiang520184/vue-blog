---
title: js基本数据类型和引用数据类型的区别
categories: 技术
comments: true
photos: javascript
date: 2019-05-07 10:45:12
tags:
keywords:
description:
---

## 栈（stack）和堆（heap）
    stack为自动分配的内存空间，它由系统自动释放；而heap则是动态分配的内存，大小也不一定会自动释放

## js分为基本数据类型和引用数据类型
    基本数据类型指的是简单的数据段,数据大小确实，内存空间大小可以分配，他们是直接按值存放的，所以可以直接`按值访问`
    引用数据类型指的是有多个值构成的对象。
    当我们把变量赋值给一个变量时，解析器首先要确认的就是这个值是基本类型还是引用数据类型。

### 基本数据类型(放在栈中）
    Number、 String、Boolean、Null、Undefined、Symbol（ES6） 基本数据类型是按值访问的。因为可以直接操作保存在变量中的实际值。

```js
    var a = 10;
    var b = a;
    b = 20;
    console.log(a); //10
    console.log(b); //20
```
基本数据类型是对值的重新赋值，b先被赋值上了a的值10，b又被重新赋值为20。此时b的值为20，a没有被重新赋值，所以a 还是10

### 引用数据类型(存放在堆内存中的对象，每个空间大小不一样，要根据情况进行特定的配置)
    Object、Array、Function、Data 等
<font color='red'>js的引用数据类型是保存在堆内存的对象</font>
<font color='red'>与其他语言的不同是，你不可以直接访问堆内存空间中的位置和堆内存空间。只能操作对象在栈内存中的引用地址。</font>
所以，引用数据在栈内存中保存的实际上是对象在堆内存中的引用地址。通过这个引用地址可以快速查找到保存在堆内存中的对象。

```js
    var obj1 = new Object();
    var obj2 = obj1;
    obj2.name = "haha";
    console.log(obj1.name) //haha
```

这说明两个引用数据类型指向了同一个堆内存对象。obj1赋值给了obj2，实际上这个堆内存对象在栈内存堆引用地址复制了一份给了obj2,实际上他们共同指向了同一个堆内存对象。所以给obj2的某一个属性修改或赋值是obj1的属性也跟着一起改变了

### 基本类型和引用类型区别
1. 声明变量时内存分配不同
    1. 基本类型： 存在栈中，因为占据空间是固定的，可以将他们存在较小的内存中-栈中，这样便于快速查询变量的值
    2. 引用类型： 存在堆中，栈中储存的变量，只是用来查找堆中堆引用地址。
这是因为：引用值的大小会改变，所以不能把它放在栈中，否则会降低变量查找速度。相反，放在变量的栈内存中的值是该对象存储在堆内存中堆地址。地址的大小是固定的，所以把它存储在栈内存中的变量性能无任何负面影响
2. 不同的内存分配带来不同的访问机制
    在javascript中不允许直接访问保存在堆内存中的对象的，所以在访问一个对象时，首先得到的是这个对象在堆内存中的地址，然后在按照这个地址去获得这个对象中的值，这就是`按引用访问`。 而基本类型的值则是可以直接访问到到。
3. 复制变量时的不同
   1. 基本类型：在将一个保存着原始值的变量复制给另一个变量时，会将基本类型值赋值给新变量，此后两个变量是完全独立的，他们只是值相同而已
   2. 引用类型：在将一个保存着对象内存地址的变量复制给另一个变量时，会把这个变量保存在的栈内存地址赋值给新的变量。此时两个变量都指向了在堆内存中的同一个对象，它们中任何一个做出改变都会影响到另一个变量。（复制对象值不过是把栈内存中的指针复制了一个）
4. 参数传递的不同（把实参复制给形参的过程）
    1. 基本类型： 只是把变量里的值传递给实参，之后参数和变量互不影响
    2. 引用类型： 对象变量它里面的值是这个对象在堆内存中的内存地址，因此它传递的值也就是这个内存地址，这就是为什么函数内部修改了这个参数，函数外部这个对象也修改了，因为它们访问的是 同一个内存地址
   
看一下代码吧

```js
        //基本类型
        var a = 12;
        console.log(a, "a")  //12
        function fn(x) {
            x++;
            console.log(x, "fn") //13
        }
        fn(a)
        console.log(a, "a") //12


        //引用类型
        var obj = {
            a: 12,
            b: "b"
        }
        console.log(obj, "obj") //{a: 12, b: "b"}
        function fn2(obj) {
            obj.a++;
            console.log(obj, "fn2") //{a: 13, b: "b"}
        }
        fn2(obj)
        console.log(obj, "obj") //{a: 13, b: "b"}

```